<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Prescription</title>
    <style>
      /* Add your custom CSS styles here */
    </style>
  </head>
  <body>
    <h1>Prescription</h1>
    <div id="prescriptionData">
      <!-- Prescription data will be displayed here -->
    </div>
    <button id="downloadPdfBtn">Download PDF</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script>
      // Prescription data received from the API
      const prescriptionData = {
        name: 'Prescription1',
        startDate: '2024-04-28T05:00:00.000Z',
        expiryDate: '2024-04-30T05:00:00.000Z',
        medications: [
          {
            id: '662eaeb5b7ceb1b26800bedc',
            dosage: 500,
            durationNumber: 0,
            durationUnit: 'day(s)',
            frequency: 'Once a Day',
            frequencyTimings: ['Morning'],
            remarks: '',
            timing: 'Before Food',
            unit: 'MG',
            medicationId: '662eae83e507a0ef687a13e9',
            prescriptionId: '662eaeb5b7ceb1b26800bedb',
            createdAt: '2024-04-28T20:16:53.756Z',
            updatedAt: '2024-04-28T20:16:53.756Z',
            medication: {},
          },
        ],
      }

      // Function to format prescription data into HTML
      function formatPrescriptionData(data) {
        const medicationsHtml = data.medications
          .map(
            med => `
        <div>
          <p><strong>Medication ID:</strong> ${med.medicationId}</p>
          <p><strong>Dosage:</strong> ${med.dosage} ${med.unit}</p>
          <p><strong>Frequency:</strong> ${med.frequency}</p>
          <p><strong>Frequency Timings:</strong> ${med.frequencyTimings.join(', ')}</p>
          <p><strong>Timing:</strong> ${med.timing}</p>
        </div>
      `,
          )
          .join('')

        return `
        <h2>${data.name}</h2>
        <p><strong>Start Date:</strong> ${data.startDate}</p>
        <p><strong>Expiry Date:</strong> ${data.expiryDate}</p>
        <h3>Medications:</h3>
        ${medicationsHtml}
      `
      }

      // Display prescription data
      document.getElementById('prescriptionData').innerHTML =
        formatPrescriptionData(prescriptionData)

      // Function to download prescription data as PDF
      function downloadPdf() {
        const element = document.getElementById('prescriptionData')
        html2pdf(element, {
          margin: 10,
          filename: 'prescription.pdf',
          image: { type: 'jpeg', quality: 0.98 },
          html2canvas: { scale: 2 },
          jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },
        })
      }

      // Add event listener to download PDF button
      document
        .getElementById('downloadPdfBtn')
        .addEventListener('click', downloadPdf)
    </script>
  </body>
</html>
